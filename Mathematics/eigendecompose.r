
> A <- matrix(c(2,1,0,1,2,1,0,1,2),nrow=3)
> A

> eigen(A)
eigen() decomposition
$values


$vectors


> P <- eigen(A)$vectors
> P

> t(P)%*%P

> P%*%t(P)

> solve(P)

> t(P)

> t(P)%*%A%*%P

> eigen(A)$values

> A <- matrix(c(2,3,3,-6),nrow=2)
> A

> eigen(A)

$values


$vectors


> Q <- eigen(A)$vectors
> sqrt(10)*Q

> t(Q)%*%A%*%Q

> 
> 
> 
> 
> mtcars

> A <- data.matrix(mtcars)
> A
 

> dim(A)
[1] 32 11
> B <- t(A)%*%A
> dim(B)
[1] 11 11
> C <- A%*%t(A)
> dim(C)
[1] 32 32
> eigen(B)$values
 [1] 2.981350e+06 5.181903e+04 7.787369e+03 1.420598e+02 3.181173e+01 1.771687e+01
 [7] 6.666664e+00 2.633197e+00 1.966960e+00 1.376570e+00 1.221605e+00
> eigen(C)$values
 [1]  2.981350e+06  5.181903e+04  7.787369e+03  1.420598e+02  3.181173e+01
 [6]  1.771687e+01  6.666664e+00  2.633197e+00  1.966960e+00  1.376570e+00
[11]  1.221605e+00  5.254854e-10  2.311415e-11  1.358300e-11  1.035616e-11
[16]  9.666347e-12  6.279653e-12  6.208252e-12  5.282727e-12  4.236612e-12
[21] -4.462680e-13 -7.705049e-13 -1.569729e-12 -3.465535e-12 -3.469925e-12
[26] -4.312909e-12 -5.281603e-12 -6.397009e-12 -1.872531e-11 -2.111077e-11
[31] -2.132858e-11 -2.490795e-11
> plot(eigen(B)$values)
> plot(eigen(C)$values)
> eigen(B)$values
 [1] 2.981350e+06 5.181903e+04 7.787369e+03 1.420598e+02 3.181173e+01 1.771687e+01
 [7] 6.666664e+00 2.633197e+00 1.966960e+00 1.376570e+00 1.221605e+00
> sum(eigen(B)$values)
[1] 3041162
> L <- eigen(B)$values
> L[1]
[1] 2981350
> sum(L)
[1] 3041162
> L[1]/sum(L)
[1] 0.9803326
> (L[1]+L[2])/sum(L)
[1] 0.9973718
> P <- eigen(B)$vectors
> P
               [,1]         [,2]         [,3]          [,4]         [,5]
 [1,] -0.0519257049  0.121688949  0.816770206 -0.5384199012  0.014048862
 [2,] -0.0205575213  0.013536320  0.068072076  0.0965395213  0.220032664
 [3,] -0.8522586529 -0.522344943  0.009452163 -0.0223072691  0.007183881
 [4,] -0.5171930285  0.840499218 -0.157726895  0.0009687559 -0.033835232
 [5,] -0.0101007815  0.021353136  0.107698845  0.0342661459  0.167587424
 [6,] -0.0106761161  0.001393600  0.041280981  0.1922831371  0.140708770
 [7,] -0.0513164688  0.059991397  0.527215368  0.7978592891 -0.163778474
 [8,] -0.0007636558  0.003258089  0.033024924  0.0656951946 -0.129987388
 [9,] -0.0008299319  0.009037851  0.019697342 -0.0872261559  0.116191461
[10,] -0.0103899117  0.027963222  0.102686163  0.0060848459  0.302646369
[11,] -0.0094372579  0.028183106  0.001794994  0.1166099188  0.868039131
              [,6]         [,7]          [,8]         [,9]        [,10]
 [1,]  0.013816129  0.154363021 -5.982745e-03  0.006090030  0.030682991
 [2,]  0.931676842 -0.152224599 -4.219918e-02 -0.106913819  0.121628506
 [3,] -0.011317652 -0.001053026  7.603304e-05 -0.003643087 -0.005378992
 [4,] -0.002990773  0.004028480  1.033715e-03  0.003814106  0.001823762
 [5,] -0.109754122 -0.486608996  8.135056e-01 -0.081293045  0.170089863
 [6,] -0.072667175  0.255642070 -3.430539e-02  0.423057913  0.830688325
 [7,] -0.055035576 -0.012167276 -3.641436e-02  0.051636264 -0.212658963
 [8,] -0.167858918  0.107981327  1.564492e-02 -0.664504674  0.314529303
 [9,] -0.095853729 -0.332961056 -4.604892e-02  0.548573199 -0.166695069
[10,] -0.229249376 -0.627810339 -5.725818e-01 -0.210796366  0.193074492
[11,] -0.146202299  0.366093311  6.060495e-02 -0.115401657 -0.236731123
              [,11]
 [1,] -0.0159823557
 [2,]  0.1335185417
 [3,]  0.0009868866
 [4,] -0.0021876651
 [5,] -0.1114381264
 [6,] -0.0240179035
 [7,]  0.0039589416
 [8,]  0.6301659189
 [9,]  0.7263122465
[10,] -0.2016679925
[11,]  0.0599338850

> sleep
   extra group ID
1    0.7     1  1
2   -1.6     1  2
3   -0.2     1  3
4   -1.2     1  4
5   -0.1     1  5
6    3.4     1  6
7    3.7     1  7
8    0.8     1  8
9    0.0     1  9
10   2.0     1 10
11   1.9     2  1
12   0.8     2  2
13   1.1     2  3
14   0.1     2  4
15  -0.1     2  5
16   4.4     2  6
17   5.5     2  7
18   1.6     2  8
19   4.6     2  9
20   3.4     2 10
> A <- data.matrix(sleep)
> B <- t(A)%*%A
> B
      extra group    ID
extra 124.8  54.1 224.1
group  54.1  50.0 165.0
ID    224.1 165.0 770.0
> eigen(B)
eigen() decomposition
$values
[1] 876.66745  54.72341  13.40914

$vectors
           [,1]        [,2]       [,3]
[1,] -0.2930946  0.94932450  0.1134836
[2,] -0.2055497  0.05335342 -0.9771912
[3,] -0.9337263 -0.30973603  0.1794958

> A <- data.matrix(mtcars)
> B <- t(A)%*%A
> L <- eigen(B)$values
> P <- eigen(B)$vectors
> P
               [,1]         [,2]         [,3]          [,4]         [,5]
 [1,] -0.0519257049  0.121688949  0.816770206 -0.5384199012  0.014048862
 [2,] -0.0205575213  0.013536320  0.068072076  0.0965395213  0.220032664
 [3,] -0.8522586529 -0.522344943  0.009452163 -0.0223072691  0.007183881
 [4,] -0.5171930285  0.840499218 -0.157726895  0.0009687559 -0.033835232
 [5,] -0.0101007815  0.021353136  0.107698845  0.0342661459  0.167587424
 [6,] -0.0106761161  0.001393600  0.041280981  0.1922831371  0.140708770
 [7,] -0.0513164688  0.059991397  0.527215368  0.7978592891 -0.163778474
 [8,] -0.0007636558  0.003258089  0.033024924  0.0656951946 -0.129987388
 [9,] -0.0008299319  0.009037851  0.019697342 -0.0872261559  0.116191461
[10,] -0.0103899117  0.027963222  0.102686163  0.0060848459  0.302646369
[11,] -0.0094372579  0.028183106  0.001794994  0.1166099188  0.868039131
              [,6]         [,7]          [,8]         [,9]        [,10]
 [1,]  0.013816129  0.154363021 -5.982745e-03  0.006090030  0.030682991
 [2,]  0.931676842 -0.152224599 -4.219918e-02 -0.106913819  0.121628506
 [3,] -0.011317652 -0.001053026  7.603304e-05 -0.003643087 -0.005378992
 [4,] -0.002990773  0.004028480  1.033715e-03  0.003814106  0.001823762
 [5,] -0.109754122 -0.486608996  8.135056e-01 -0.081293045  0.170089863
 [6,] -0.072667175  0.255642070 -3.430539e-02  0.423057913  0.830688325
 [7,] -0.055035576 -0.012167276 -3.641436e-02  0.051636264 -0.212658963
 [8,] -0.167858918  0.107981327  1.564492e-02 -0.664504674  0.314529303
 [9,] -0.095853729 -0.332961056 -4.604892e-02  0.548573199 -0.166695069
[10,] -0.229249376 -0.627810339 -5.725818e-01 -0.210796366  0.193074492
[11,] -0.146202299  0.366093311  6.060495e-02 -0.115401657 -0.236731123
              [,11]
 [1,] -0.0159823557
 [2,]  0.1335185417
 [3,]  0.0009868866
 [4,] -0.0021876651
 [5,] -0.1114381264
 [6,] -0.0240179035
 [7,]  0.0039589416
 [8,]  0.6301659189
 [9,]  0.7263122465
[10,] -0.2016679925
[11,]  0.0599338850

> p1 <- P[,1]
> t(p1)
           [,1]        [,2]       [,3]      [,4]        [,5]        [,6]
[1,] -0.0519257 -0.02055752 -0.8522587 -0.517193 -0.01010078 -0.01067612
            [,7]          [,8]          [,9]       [,10]        [,11]
[1,] -0.05131647 -0.0007636558 -0.0008299319 -0.01038991 -0.009437258

> L[1]*p1%*%t(p1)
             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]        [,8]        [,9]       [,10]       [,11]
 [1,]   8038.5512  3182.48326  131937.059   80065.983  1563.68891  1652.75571   7944.2361  118.220573  128.480689  1608.44878  1460.96968
 [2,]   3182.4833  1259.95338   52234.224   31698.330   619.06850   654.33027   3145.1437   46.803831   50.865838   636.78904   578.40169
 [3,] 131937.0588 52234.22386 2165488.175 1314126.156 25664.88812 27126.74498 130389.0622 1940.358945 2108.758641 26399.53351 23978.95327
 [4,]  80065.9833 31698.33047 1314126.156  797477.250 15574.73329 16461.86089  79126.5817 1177.506519 1279.699847 16020.55273 14551.62399
 [5,]   1563.6889   619.06850   25664.888   15574.733   304.17459   321.50020   1545.3424   22.996706   24.992542   312.88145   284.19326
 [6,]   1652.7557   654.33027   27126.745   16461.861   321.50020   339.81266   1633.3642   24.306585   26.416103   330.70299   300.38074
 [7,]   7944.2361  3145.14369  130389.062   79126.582  1545.34240  1633.36419   7851.0276  116.833509  126.973245  1589.57710  1443.82835
 [8,]    118.2206    46.80383    1940.359    1177.507    22.99671    24.30658    116.8335    1.738635    1.889527    23.65498    21.48605
 [9,]    128.4807    50.86584    2108.759    1279.700    24.99254    26.41610    126.9732    1.889527    2.053515    25.70794    23.35077
[10,]   1608.4488   636.78904   26399.534   16020.553   312.88145   330.70299   1589.5771   23.654976   25.707942   321.83753   292.32816
[11,]   1460.9697   578.40169   23978.953   14551.624   284.19326   300.38074   1443.8284   21.486045   23.350774   292.32816   265.52452
> B

> p2 <- P[,2]
> L[1]*p1%*%t(p1)+L[2]*p2%*%t(p2)

> B

> mtcars
